stages:
  - test

cache:
  paths:
    - .cache/pip
    - venv

test-api:
  stage: test
  image: python:3.7
  variables:
    ENV: "test"
    LOG_LEVEL: "debug"
    SQLALCHEMY_DATABASE_URI: "postgresql+psycopg2://test:test@localhost:5432/test"
  before_script:
    - pip install poetry
    - poetry install
    - source `poetry env info --path`/bin/activate
  script:
    - pytest

